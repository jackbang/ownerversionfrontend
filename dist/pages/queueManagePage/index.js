(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[16],{106:function(e,t,a){e.exports=a.p+"img/scoreDeactive.png"},293:function(e,t,a){},294:function(e,t,a){e.exports=a.p+"img/play_pic_2.jpg"},295:function(e,t,a){e.exports=a.p+"img/member.png"},302:function(e,t,a){"use strict";a.r(t);var s=a(6),n=a(9),i=a(11),l=a(16),o=a(17),c=a(2),r=a(3),d=a.n(r),h=a(0),p=a(5),u=a(10),f=a.n(u),m=(a(41),a(293),a(294),a(30)),y=a.n(m),x=a(106),j=a.n(x),g=(a(295),a(33)),b=a.n(g),q=a(32),I=a.n(q),O=a(12),_=a(14),w=a(1),N=function(e){Object(l["a"])(a,e);var t=Object(o["a"])(a);function a(){var e;return Object(n["a"])(this,a),e=t.apply(this,arguments),e.state={adminInfo:{},storeInfo:{},queueInfo:{},playInfo:{},playerList:[],totalNum:0,male:0,female:0,showPlayerAdder:!1,infoLoading:!0},e}return Object(i["a"])(a,[{key:"componentWillMount",value:function(){this.state.adminInfo=d.a.getStorageSync("admin_info"),this.state.storeInfo=d.a.getStorageSync("store_info"),this.state.queueInfo=d.a.getStorageSync("queue_info"),this.state.playInfo=d.a.getStorageSync("play_id_".concat(this.state.queueInfo.play_id))}},{key:"componentDidShow",value:function(){this.setState({infoLoading:!0});var e={adminId:this.state.adminInfo.adminId,sessionId:this.state.adminInfo.sessionId,queue_id:this.state.queueInfo.queue_id,appId:wx.getAccountInfoSync().miniProgram.appId,token:2*(f()().unix()+1e3)},t=this;Object(O["i"])(e).then((function(e){console.log(e.data),1==e.data.code?t.setState({playerList:e.data.data,infoLoading:!1}):console.log(e.data.data)}))}},{key:"handleNavBack",value:function(){d.a.navigateBack()}},{key:"handleAddPlayer",value:function(){this.setState({showPlayerAdder:!0})}},{key:"handleChangeTotal",value:function(e){this.setState({totalNum:e})}},{key:"handleChangeMale",value:function(e){this.setState({male:e})}},{key:"handleChangeFemale",value:function(e){this.setState({female:e})}},{key:"handleCancle",value:function(){this.setState({totalNum:0,male:0,female:0,showPlayerAdder:!1})}},{key:"handleConfirm",value:function(){var e={adminId:this.state.adminInfo.adminId,sessionId:this.state.adminInfo.sessionId,queue_id:this.state.queueInfo.queue_id,totalNum:this.state.totalNum,maleNum:this.state.male,femaleNum:this.state.female,appId:wx.getAccountInfoSync().miniProgram.appId,token:2*(f()().unix()+1e3)},t=this;Object(O["c"])(e).then((function(e){console.log(e.data),1==e.data.code?t.setState({playerList:e.data.data,infoLoading:!1}):console.log(e.data.data)})),this.setState({totalNum:0,male:0,female:0,showPlayerAdder:!1})}},{key:"removePlayer",value:function(e){var t={adminId:this.state.adminInfo.adminId,sessionId:this.state.adminInfo.sessionId,queue_id:this.state.queueInfo.queue_id,player_id:e,appId:wx.getAccountInfoSync().miniProgram.appId,token:2*(f()().unix()+1e3)},a=this;Object(O["n"])(t).then((function(e){console.log(e.data),1==e.data.code?a.setState({playerList:e.data.data,infoLoading:!1}):console.log(e.data.data)}))}},{key:"lockTheQueue",value:function(){var e=this.state.queueInfo,t=this;console.log(e),wx.showModal({title:"\u9501\u5b9a\u8f66\u961f",content:"\u786e\u5b9a\u9501\u5b9a ".concat(e.queue_end_time.slice(0,10)+" "+e.queue_end_time.slice(11,-3)," \u4eba\u6570\u4e3a").concat(e.queue_current_num,"\u4eba\u7684\u8f66\u961f\u5417\uff1f"),success:function(a){if(a.confirm){console.log("\u7528\u6237\u70b9\u51fb\u786e\u5b9a");var s={adminId:t.state.adminInfo.adminId,sessionId:t.state.adminInfo.sessionId,store_id:t.state.storeInfo.store_id,queue_id:e.queue_id,appId:wx.getAccountInfoSync().miniProgram.appId,token:2*(f()().unix()+1e3)};Object(O["m"])(s).then((function(e){1==e.data.code?d.a.navigateBack():console.log(e.data.data)}))}else a.cancel&&console.log("\u7528\u6237\u70b9\u51fb\u53d6\u6d88")}})}},{key:"deleteTheQueue",value:function(){var e=this.state.queueInfo,t=this;console.log(e),wx.showModal({title:"\u89e3\u6563\u8f66\u961f",content:"\u786e\u5b9a\u89e3\u6563 ".concat(e.queue_end_time.slice(0,10)+" "+e.queue_end_time.slice(11,-3)," \u4eba\u6570\u4e3a").concat(e.queue_current_num,"\u4eba\u7684\u8f66\u961f\u5417\uff1f"),success:function(a){if(a.confirm){console.log("\u7528\u6237\u70b9\u51fb\u786e\u5b9a");var s={adminId:t.state.adminInfo.adminId,sessionId:t.state.adminInfo.sessionId,store_id:t.state.storeInfo.store_id,queue_id:e.queue_id,appId:wx.getAccountInfoSync().miniProgram.appId,token:2*(f()().unix()+1e3)};Object(O["f"])(s).then((function(e){1==e.data.code?d.a.navigateBack():console.log(e.data.data)}))}else a.cancel&&console.log("\u7528\u6237\u70b9\u51fb\u53d6\u6d88")}})}},{key:"onScrollToUpper",value:function(){}},{key:"onScroll",value:function(e){}},{key:"render",value:function(){var e=this,t=wx.getSystemInfoSync().statusBarHeight,a=wx.getSystemInfoSync().screenWidth/3,s=(wx.getSystemInfoSync().screenHeight,wx.getSystemInfoSync().screenWidth),n=wx.getSystemInfoSync().windowHeight,i=n/s*750,l=t/s*750,o=0,c=20,r={height:"".concat(i-l-90-150,"rpx")};if(1==this.state.infoLoading)return Object(w["jsx"])(h["q"],{className:"",style:{height:"600rpx",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"},children:Object(w["jsx"])(h["q"],{children:Object(w["jsx"])(p["a"],{mode:"center",size:64,content:"Loading...",className:"load"})})});var d=[],u=[];999==this.state.playInfo.play_male_num||999==this.state.playInfo.play_female_num?(d=[],u.push(Object(w["jsxs"])(h["q"],{className:"at-row",style:"height:180rpx;padding-top:3%;padding-bottom:3%;",children:[Object(w["jsx"])(h["q"],{className:"at-col",style:"font-size:16px;font-weight:600;color:#000;align-items:center;display:flex;justify-content:flex-start;padding-left:8%",children:"\u73a9\u5bb6\u6570"}),Object(w["jsx"])(h["q"],{className:"at-col",style:"align-items:center;display:flex;justify-content:flex-end;padding-right:10%;",children:Object(w["jsx"])(p["f"],{className:"queue-join-input-number",min:0,max:this.state.playInfo.play_headcount-this.state.queueInfo.queue_current_num,step:1,value:this.state.totalNum,onChange:this.handleChangeTotal.bind(this)})})]}))):(d.push(Object(w["jsx"])(h["q"],{style:"display:flex;align-items:flex-end;padding-left:3%;position:relative;bottom:0%;",children:Object(w["jsxs"])("text",{style:"background-color:#c0c0c0;color:rgb(80, 80, 80);padding: 0% 10%;border-radius:3px;",children:[this.state.playInfo.play_male_num,"\u7537",this.state.playInfo.play_female_num,"\u5973"]})})),u.push(Object(w["jsxs"])(h["q"],{className:"at-row",style:"height:90rpx;",children:[Object(w["jsx"])(h["q"],{className:"at-col",style:"font-size:16px;font-weight:600;color:#000;align-items:center;display:flex;justify-content:flex-start;padding-left:8%",children:"\u7537\u73a9\u5bb6"}),Object(w["jsx"])(h["q"],{className:"at-col",style:"align-items:center;display:flex;justify-content:flex-end;padding-right:10%",children:Object(w["jsx"])(p["f"],{className:"queue-join-input-number",min:0,max:this.state.playInfo.play_male_num-this.state.queueInfo.queue_current_male_num,step:1,value:this.state.male,onChange:this.handleChangeMale.bind(this)})})]})),u.push(Object(w["jsxs"])(h["q"],{className:"at-row",style:"height:90rpx;",children:[Object(w["jsx"])(h["q"],{className:"at-col",style:"font-size:16px;font-weight:600;color:#000;align-items:center;display:flex;justify-content:flex-start;padding-left:8%",children:"\u5973\u73a9\u5bb6"}),Object(w["jsx"])(h["q"],{className:"at-col",style:"align-items:center;display:flex;justify-content:flex-end;padding-right:10%",children:Object(w["jsx"])(p["f"],{className:"queue-join-input-number",min:0,max:this.state.playInfo.play_female_num-this.state.queueInfo.queue_current_female_num,step:1,value:this.state.female,onChange:this.handleChangeFemale.bind(this)})})]})));var f=[];this.state.playerList.map((function(t,a){f.push(Object(w["jsxs"])(h["q"],{style:"display:flex;width:100%;margin-left:5%;align-items:center;padding-bottom:10rpx;padding-top:10rpx;",children:[Object(w["jsx"])("image",{src:t.player_pic,style:"height:100rpx;width:100rpx;background:#D8D8D8;border-radius:50rpx"}),Object(w["jsxs"])(h["q"],{style:"display:flex;flex-direction:column;justify-content:flex-start;",children:[Object(w["jsxs"])(h["q"],{style:"display:flex;align-item:center;height:60rpx;",children:[Object(w["jsx"])("text",{style:"font-size:12px;font-weight:520;",children:t.player_name}),Object(w["jsx"])("image",{src:3==t.player_gender?null:0==t.player_gender?I.a:b.a,style:"height:25rpx;width:25rpx;"})]}),Object(w["jsx"])("text",{style:"font-size:10px;text-decoration:underline;",children:t.player_tel})]}),Object(w["jsx"])(h["q"],{style:"width:120rpx;position:absolute;margin-right:7%;right:0;",children:Object(w["jsx"])(p["b"],{type:"primary",circle:"true",className:"remove-player-but",onClick:e.removePlayer.bind(e,t.player_id),children:"\u79fb\u9664\u8f66\u961f"})})]}))}));var m=[];return this.state.playInfo.play_labels.map((function(e){m.push(Object(w["jsx"])("text",{className:"play-label-info",children:e}))})),Object(w["jsxs"])(h["q"],{className:"queueManagePage",children:[Object(w["jsx"])("image",{className:"queue-info-page",src:_["a"]+this.state.playInfo.play_img,style:"width:100vw;height:100vh;position:absolute;z-index:-1;"}),Object(w["jsxs"])(h["q"],{className:"at-col",style:{padding:"".concat(t,"px 0px 0px 0px"),position:"absolute",top:0,left:0,width:"100%"},children:[Object(w["jsx"])(p["g"],{className:"nav-bar-info",onClickLeftIcon:this.handleNavBack.bind(this),color:"#ffff",leftIconType:"chevron-left",children:Object(w["jsx"])(h["q"],{style:"color:#fff;font-size:18px",children:"\u8f66\u961f\u8be6\u60c5"})}),Object(w["jsxs"])(h["j"],{className:"scrollview",scrollY:!0,scrollWithAnimation:!0,"show-scrollbar":"false",scrollTop:o,style:r,lowerThreshold:c,upperThreshold:c,onScrollToUpper:this.onScrollToUpper.bind(this),onScroll:this.onScroll,children:[Object(w["jsxs"])(h["q"],{className:"at-row",style:"height:300rpx;padding-top:5%;",children:[Object(w["jsx"])(h["q"],{className:"at-row play-pic-position-info",style:{width:"".concat(a,"px")},children:Object(w["jsx"])("image",{src:_["a"]+this.state.playInfo.play_img,style:"height:100%;width:90%;border-radius:10px;",children:Object(w["jsx"])("text",{className:"play-pic-label-info",children:this.state.playInfo.play_labels[0]})})}),Object(w["jsxs"])(h["q"],{className:"at-col",children:[Object(w["jsx"])(h["q"],{className:"play-name-position-info",children:this.state.playInfo.play_name}),Object(w["jsxs"])(h["q"],{className:"play-score-position-info",children:["\u96be\u5ea6",Object(w["jsxs"])(h["q"],{style:"display:flex;align-items:flex-end;padding-left:3%;position:relative;bottom:0%",children:[Object(w["jsx"])("image",{src:y.a,className:"play-score-pic-info",style:"position:relative;left:-0px;"}),Object(w["jsx"])("image",{src:y.a,className:"play-score-pic-info",style:"position:relative;left:-3px;"}),Object(w["jsx"])("image",{src:y.a,className:"play-score-pic-info",style:"position:relative;left:-6px;"}),Object(w["jsx"])("image",{src:j.a,className:"play-score-pic-info",style:"position:relative;left:-9px;"}),Object(w["jsx"])("image",{src:j.a,className:"play-score-pic-info",style:"position:relative;left:-12px;"})]})]}),Object(w["jsxs"])(h["q"],{className:"play-headcount-position-info",children:[this.state.playInfo.play_headcount,"\u4eba\u672c",d]}),Object(w["jsxs"])(h["q"],{className:"play-duration-position-info",children:["\u6e38\u620f\u65f6\u957f\u7ea6",this.state.playInfo.play_duration,"\u5c0f\u65f6"]}),Object(w["jsx"])(h["q"],{className:"play-label-position-info",children:m})]})]}),Object(w["jsxs"])(h["q"],{style:{minHeight:"".concat(i-l-90-335-30-150,"rpx"),background:"#F9F9F9",marginTop:"5%"},children:[Object(w["jsxs"])(h["q"],{className:"at-row queue-time-tab-info",style:"padding-top:2%",children:[Object(w["jsx"])(h["q"],{className:"at-row",children:Object(w["jsxs"])(h["q"],{className:"at-col",children:[Object(w["jsx"])(h["q"],{className:"at-row queue-start-time-info",children:"\u5f00\u5c40\u65f6\u95f4"}),Object(w["jsx"])(h["q"],{className:"at-row",style:"font-size:14px;color:#000;height:70%;align-items:center;display:flex;justify-content:flex-start;padding-left:10%;",children:this.state.queueInfo.queue_end_time.slice(0,10)+" "+this.state.queueInfo.queue_end_time.slice(11,-3)})]})}),Object(w["jsx"])(h["q"],{className:"at-row",children:Object(w["jsxs"])(h["q"],{className:"at-col",children:[Object(w["jsx"])(h["q"],{className:"at-row queue-antigender-info",children:"\u662f\u5426\u63a5\u53d7\u53cd\u4e32"}),Object(w["jsxs"])(h["q"],{className:"at-row",style:"font-size:14px;color:#000;height:70%;align-items:center;display:flex;justify-content:flex-start;padding-left:10%;",children:[1==this.state.queueInfo.queue_allow_antigender?"":"\u4e0d","\u63a5\u53d7\u53cd\u4e32"]})]})})]}),Object(w["jsxs"])(h["q"],{className:"at-row queue-player-tab-info",style:"padding-top:2%",children:[Object(w["jsxs"])(h["q"],{style:"display:flex;width:100%;margin-left:5%;align-items:center;",children:[Object(w["jsx"])("text",{style:"font-size:14px;",children:"\u8f66\u961f\u6210\u5458"}),Object(w["jsxs"])("text",{style:"font-size:10px;",children:["\uff08",this.state.playerList.length,"/",this.state.playInfo.play_headcount,"\uff09"]}),Object(w["jsx"])(h["q"],{style:"width:50rpx;position:absolute;margin-right:10%;right:0;",children:Object(w["jsx"])(p["b"],{type:"primary",circle:"true",className:"add-player-but",onClick:this.handleAddPlayer.bind(this),children:"\u6dfb\u52a0"})})]}),Object(w["jsx"])(h["q"],{style:"height:10rpx;margin-left:5%;margin-right:5%;border:0px solid #97979755;border-bottom-width:1px;margin-bottom:20rpx;"}),f,Object(w["jsx"])(h["q"],{style:"height:20rpx;"})]})]})]}),Object(w["jsxs"])(h["q"],{className:"at-row",style:"position:fixed;bottom:0;height:150rpx;padding-top:2%;background-color:#fff",children:[Object(w["jsx"])(p["b"],{type:"second",circle:"true",className:"invite-friends-button",onClick:this.deleteTheQueue.bind(this),children:"\u89e3\u6563\u8be5\u5c40"}),Object(w["jsx"])(p["b"],{type:"primary",circle:"true",className:"join-queue-button",onClick:this.lockTheQueue.bind(this),children:"\u786e\u8ba4\u9501\u5c40"})]})]}),Object(w["jsx"])(h["q"],{style:{visibility:1==this.state.showPlayerAdder?"visible":"hidden",height:"100vh",width:"100vw",background:"#00000080",position:"absolute",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(w["jsxs"])(h["q"],{style:"width:80vw;height:400rpx;background:#ffffff;border-radius:20rpx;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;",children:[Object(w["jsx"])("text",{style:"font-size:20px;font-weight:530;margin-top:20rpx;",children:"\u6dfb\u52a0\u6210\u5458"}),u,Object(w["jsxs"])(h["q"],{style:"height:100rpx;width:90%;display:flex;align-items:center;justify-content:center;",children:[Object(w["jsx"])(p["b"],{type:"second",circle:"true",className:"add-player-cancle-button",onClick:this.handleCancle.bind(this),children:"\u53d6\u6d88"}),Object(w["jsx"])(p["b"],{type:"primary",circle:"true",className:"add-player-confirm-button",onClick:this.handleConfirm.bind(this),children:"\u786e\u5b9a"})]})]})})]})}}]),a}(c["Component"]),v={navigationBarTitleText:"\u8f66\u961f\u8be6\u60c5",disableScroll:!0};Page(Object(s["createPageConfig"])(N,"pages/queueManagePage/index",{root:{cn:[]}},v||{}))}},[[302,0,1,2,3]]]);